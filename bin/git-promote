#!/usr/bin/env ruby

require 'grit'
require File.join(File.dirname(__FILE__), '..', 'lib', 'socialcast-git-extensions.rb')
include Socialcast

repo = Grit::Repo.new(Dir.pwd)
branch = Grit::Head.current(repo).name

update(branch)
integrate(branch, 'next_release')

ticket = ARGV.shift
raise 'JIRA ticket is required in order to move into next_release'
update_ticket ticket, {:branch => branch, :in_staging => true}
resolve_ticket ticket

integrate(branch, 'staging')
