#!/usr/bin/env ruby

require 'grit'
require File.join(File.dirname(__FILE__), '..', 'lib', 'socialcast-git-extensions.rb')
include Socialcast

repo = Grit::Repo.new(Dir.pwd)
branch = Grit::Head.current(repo).name

update(branch)
integrate(branch, 'staging')

ticket = ARGV.shift
if ticket
  update_ticket ticket, {:branch => branch, :in_staging => true}
  start_ticket ticket
end
